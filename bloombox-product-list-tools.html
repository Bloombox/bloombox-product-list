
<!--
`<bloombox-product-list-tools>` provides UI for filtering, searching,
and easily navigating a `<bloombox-product-list>`.

@group Bloombox Elements
@element bloombox-product-list-tools
@demo demo/index.html
@homepage bloombox.github.io
-->

<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-iconset/iron-iconset.html">

<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-toolbar/paper-toolbar.html">
<link rel="import" href="../paper-checkbox/paper-checkbox.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">

<link rel="import" href="../bloombox-styles/bloombox-styles.html">


<dom-module id="bloombox-product-list-tools">
  <template>
    <style is="custom-style" include="bloombox-styles">
      :root {
        --paper-input-container-input-color: white;
        --paper-input-container-color: white;
        --paper-input-container-focus-color: white;
        --paper-input-container-input-color: white;
        --paper-icon-button-ink-color: rgba(0, 0, 0, 0.4);
      }

      :host {
        height: 56px;
        display: block;
        background: #ddd;
      }

      :host #productListToolbar {
        --paper-toolbar-height: 56px;
        --paper-toolbar-sm-height: 56px;
      }

      :host paper-toolbar div[title] {
        flex: 1 0 40%;
        text-align: right;
        font-size: 80%;
      }

      :host #searchInput {
        flex: 1 1 40%;

        height: 50px;
        margin-top: 4px;

        --paper-input-container: {
          height: 50px;
          color: white;
        };

        --paper-input-container-color: white;
        --paper-input-container-focus-color: white;
        --paper-input-container-input-color: white;
      }

      :host paper-icon-button {
        flex: 1 0 30px;
        max-width: 40px;
        margin-right: 2px;
        margin-left: -8px;
      }

      input::-webkit-input-placeholder {
        color: white;
      }
    </style>

    <div class="product-list-toolbar-container">
      <paper-toolbar id="productListToolbar">
        <paper-icon-button toggles active="{{multiselect}}" icon="list"></paper-icon-button>
        <paper-input id="searchInput" disabled$="[[multiselect]]" label="Search" value="{{search}}" no-label-float></paper-input>
        <div title>[[_titleLabel]]</div>
      </paper-toolbar>
    </div><!-- end .product-list-toolbar-container -->
  </template>
  
  <script>
    Polymer.BloomboxProductListTools = Polymer({
      is: 'bloombox-product-list-tools',

      properties: {
        /**
         * Computed property that provides an appropriate label
         * for the toolbar depending on the number of items
         * total and the number of items showing.
         */
        _titleLabel: {
          type: String,
          notify: true,
          computed: '_computeTitleLabel(multiselect, heading, countOfItems, countOfVisibleItems, countOfSelectedItems)'
        },

        /**
         * Current section that we are displaying tools for.
         */
        section: {
          type: String,
          notify: true,
          reflectToAttribute: true
        },

        /**
         * Human-readable label for the section that we are
         * displaying tools for.
         */
        heading: {
          type: Boolean,
          notify: true,
          reflectToAttribute: true
        },

        /**
         * Activate or deactivate multiselection UI.
         */
        multiselect: {
          type: Boolean,
          notify: true,
          reflectToAttribute: true,
          value: false
        },

        /**
         * Holds the current count of total items, so it may
         * be displayed to the user when things are filtered
         * out.
         */
        countOfItems: {
          type: Number,
          notify: true
        },

        /**
         * Holds the current count of visible items, so it may
         * be displayed to the user when things are filtered out.
         */
        countOfVisibleItems: {
          type: Number,
          notify: true
        },

        /**
         * Holds the current count of selected items, so it may
         * be displayed when the user is in `multiselect` mode.
         */
        countOfSelectedItems: {
          type: Number,
          notify: true,
          value: 0
        },

        /**
         * Holds the current search terms, submitted by the user
         * if they wish to filter the list.
         */
        search: {
          type: String,
          notify: true
        }
      },

      _computeTitleLabel: function(multiselect, heading, countOfItems, countOfVisibleItems, countOfSelectedItems) {
        // Special case: if we're in apothecary, they're called 'items'
        if (heading.toLowerCase() === "apothecary") {
          heading = "Items";
        }
        if (multiselect !== true) {
          // is there a search active?
          if (countOfItems === countOfVisibleItems) {
            return "Showing " + countOfItems + " " + heading.toLowerCase();
          }
          return "Showing " + countOfVisibleItems + " of " + countOfItems + " " + heading.toLowerCase();
        }
        if (countOfItems === countOfVisibleItems) {
          // is there no search active?
          return "Selected " + countOfSelectedItems + " of " + countOfItems + " " + heading.toLowerCase(); 
        } else {
          // there is both a search and multiselect mode
          return "Selected " + countOfSelectedItems + " of " + countOfVisibleItems + " visible " + heading.toLowerCase();
        }
      }
    });
  </script>
</dom-module>
